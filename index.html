<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bar Charts</title>

    <link rel="stylesheet" href="style.css">
</head>

<style>

</style>

<body>
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <div>
        <h1>Female Representation at MoMA</h1>
        <p>Based on this <a
                href="https://www.tate.org.uk/art/artworks/guerrilla-girls-do-women-have-to-be-naked-to-get-into-the-met-museum-p78793"
                target="_blank" rel="noopener noreferrer">
                Guerrilla Girls poster</a>, we decided to investigate the gender distribution of artists exhibited at major museums. We asked the
            question <i>"Do we lack female representation at the MoMA?"</i> To answer this, we looked at a Dataset of
            all artworks exhibited by the MoMA up to late 2020.
            <br>
            We initially assumed that there would be disproportionally more male artists exhibited, a ratio confirmed by
            this dataset.
        </p>
        <svg id="chart1" width="960" height="540"></svg>
        <p>Question!!</p>
        <svg id="chart2" width="960" height="540"></svg>
        <p>Question!!</p>
    </div>
</body>

<script>
    // Constants
    var margin = { top: 20, right: 30, bottom: 70, left: 100 },
        width = 560 - margin.left - margin.right,
        height = 520 - margin.top - margin.bottom;

    // Chart SVGs
    var chart1 = d3.select("#chart1")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .attr("class", "bar-chart")
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var chart2 = d3.select("#chart2")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .attr("class", "bar-chart")
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    // Linear Gradient
    const defs = chart2.append('defs');
    const bgGradient = defs
        .append('linearGradient')
        .attr('id', 'bg-gradient')
        .attr('gradientTransform', 'rotate(90)');
    bgGradient
        .append('stop')
        .attr('stop-color', '#fafafa')
        .attr('offset', '20%');
    bgGradient
        .append('stop')
        .attr('stop-color', 'lightblue')
        .attr('offset', '100%');

    // Draw Axes and Bars
    const draw = (arr, min = 0, max, svg) => {
        const x = d3.scaleBand()
            .rangeRound([0, width])
            .padding(0.1)
            .domain(arr.map(d => d.gender));

        const y = d3.scaleLinear()
            .rangeRound([height, 0])
            .domain([min, max]);

        const entries = svg.selectAll("g")
            .data(genderCount)
            .enter()
            .append("g");

        entries.each(function (d) {
            const entry = d3.select(this);
            entry.append("rect")
                .attr("class", "bar")
                .attr("x", x(d.gender))
                .attr("y", y(d.count))
                .attr("height", height - y(d.count))
                .attr("width", x.bandwidth())
                .style("fill", d => d.color)
        })

        svg.append("g")
            .attr("transform", "translate(0," + (height) + ")")
            .call(d3.axisBottom(x));

        svg.append("g")
            .call(d3.axisLeft(y));
    }

    const drawAxisLabels = (svg) => {
        svg.append("text")
            .attr("class", "x-label")
            .attr("text-anchor", "middle")
            .attr("x", width / 2)
            .attr("y", height + margin.bottom * 0.65)
            .text("Artists Gender");

        svg.append("text")
            .attr("class", "y-label")
            .attr("text-anchor", "middle")
            .attr("transform", "rotate(-90)")
            .attr("x", -height / 2)
            .attr("y", -margin.left * 0.6)
            .text("Number of Artists");
    }

    data = d3.csv('Artworks.csv').then(data => {
        genderCount = {
            Male: { gender: "Male", count: 0, color: "lightblue" },
            Female: { gender: "Female", count: 0, color: "lightblue" }
        };

        data.forEach(d => {
            const gender = d.Gender;

            const maleCount = (gender.match(/(Male)/g) || []).length
                + (gender.match(/(male)/g) || []).length

            genderCount["Male"].count += maleCount;

            const femaleCount = (gender.match(/(Female)/g) || []).length
                + (gender.match(/(female)/g) || []).length

            genderCount["Female"].count += femaleCount;
        });

        genderCount = d3.values(genderCount);

        const max = d3.max(genderCount, d => d.count);

        draw(genderCount, 18000, max, chart1);

        drawAxisLabels(chart1);
    });

    data2 = d3.json('Artists.json').then(data => {
        genderCount = {
            Male: { gender: "Male", count: 0, color: "url(#bg-gradient)" },
            Female: { gender: "Female", count: 0, color: "lightblue" },
        };


        data.forEach(d => {
            const gender = d.Gender;

            if (gender != null)
                gender == "Male" ? genderCount["Male"].count++ : genderCount["Female"].count++;

        });

        genderCount = d3.values(genderCount);

        const max = d3.max(genderCount, d => d.count);

        draw(genderCount, 0, max, chart2);

        drawAxisLabels(chart2);
    });

</script>

</html>